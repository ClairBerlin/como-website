import{o as p,f as h,g as e,t as _,a0 as y,r as m,b as j,C as B,a as v,G as F,i as I,n as L}from"./index.76046ed7.js";import{_ as N,a as M}from"./FreshAirMedal.f31e3919.js";import{i as O}from"./index.285a1daf.js";var q="/dashboard/assets/como-logo.fc3e99d7.svg";const A={class:"flex w-full flex-row items-center justify-between"},S=e("svg",{width:"16",height:"24",viewBox:"0 0 16 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M13.7871 22L2 12L13.7871 2",stroke:"#385BA7","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"})],-1),E=[S],R={class:"flex select-none flex-col items-center text-[#385BA7]"},P={class:"text-sm"},V={class:"text-sm font-bold"},Z=e("svg",{width:"16",height:"24",viewBox:"0 0 16 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M2.00004 2L13.7871 12L2.00004 22",stroke:"#385BA7","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"})],-1),z=[Z],G={__name:"InstallationSwitch",props:{numberOfInstallations:{type:Number,required:!0},currentInstallation:{type:Number,required:!0},roomName:{type:String,required:!0}},emits:["previous","next"],setup(i,{emit:r}){const n=()=>r("previous"),o=()=>r("next");return(s,f)=>(p(),h("div",A,[e("div",{class:"rounded p-6 hover:bg-[#F1F9FE]",onClick:n},E),e("div",R,[e("div",P,_(i.currentInstallation)+"/"+_(i.numberOfInstallations),1),e("div",V,_(i.roomName),1)]),e("div",{class:"rounded p-6 hover:bg-[#F1F9FE]",onClick:o},z)]))}},K={key:0,class:"mx-auto flex min-h-[359px] max-w-[359px] flex-col items-center justify-center gap-6 rounded-lg bg-white p-4"},W={key:1,class:"flex justify-center font-semibold"},H={key:2,class:"mx-auto flex max-w-[359px] flex-col items-center gap-6 rounded-lg bg-white p-4"},J=["src"],Q={class:"mt-[-12px] mb-4 text-[#7886C2]"},T={class:"flex gap-2"},U=e("svg",{width:"18",height:"24",viewBox:"0 0 18 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M8.57147 0C3.20402 0 0 3.52459 0 9.42862C0 15.8692 7.64575 23.4361 7.97147 23.755C8.13169 23.912 8.34711 24 8.57147 24C8.79583 24 9.01125 23.912 9.17148 23.755C9.49719 23.4361 17.1429 15.8692 17.1429 9.42862C17.1429 3.52459 13.9389 0 8.57147 0ZM8.57147 12.0001C7.72383 12.0001 6.89523 11.7487 6.19044 11.2778C5.48566 10.8069 4.93635 10.1375 4.61197 9.3544C4.28759 8.57129 4.20272 7.70957 4.36808 6.87822C4.53345 6.04687 4.94163 5.28322 5.541 4.68385C6.14037 4.08448 6.90402 3.6763 7.73537 3.51094C8.56672 3.34557 9.42844 3.43044 10.2116 3.75482C10.9947 4.0792 11.664 4.62851 12.1349 5.3333C12.6059 6.03808 12.8572 6.86669 12.8572 7.71432C12.8558 8.85056 12.4039 9.93986 11.6004 10.7433C10.797 11.5467 9.7077 11.9987 8.57147 12.0001Z",fill:"currentColor"})],-1),X={class:"text-lg font-bold"},te={__name:"Widget",setup(i){const r=y(),n=m(!1),o=j(),s=m([]),f=m(!1);B(async()=>{n.value=!0;const g=r.params.siteId,x=await o.dispatch("jv/get",`sites/${g}`),c=await o.dispatch("jv/get",`sites/${g}/rooms`),u=Object.entries(c).map(async([a,d])=>{const b=await o.dispatch("jv/get",`rooms/${a}/installations`),$=await o.dispatch("jv/get",`rooms/${a}/airquality`,{root:!0});f.value=$.clean_air_medal,Object.entries(b).map(([k,l])=>{(l==null?void 0:l.is_public)&&O(l)&&s.value.push({roomId:a,site:x,room:d,installationId:k,installation:l})})});n.value=!1,await Promise.all(u)});const t=m(1),w=()=>{t.value-1<=0?t.value=s.value.length:t.value-=1},C=()=>{t.value+1>s.value.length?t.value=1:t.value+=1};return(g,x)=>{var c,u,a,d;return n.value?(p(),h("div",K,[v(F,{"additional-classes":"border-[#1e398f]"})])):s.value.length===0?(p(),h("div",W," Keine Daten vorhanden. ")):(p(),h("div",H,[e("img",{class:"mt-6 h-12 w-auto",src:I(q),alt:"COMo Logo"},null,8,J),e("div",Q,[e("div",T,[U,e("div",X,_(s.value[t.value-1].site.name),1)])]),v(N,{ppm:(u=(c=s.value[t.value-1].installation)==null?void 0:c.latest_sample)==null?void 0:u.co2_ppm,timestamp:new Date(((d=(a=s.value[t.value-1].installation)==null?void 0:a.latest_sample)==null?void 0:d.timestamp_s)*1e3)},null,8,["ppm","timestamp"]),v(M,{inactive:!1,class:L([f.value?"":"hidden"])},null,8,["class"]),v(G,{"number-of-installations":s.value.length,"current-installation":t.value,"room-name":s.value[t.value-1].room.name,onPrevious:w,onNext:C},null,8,["number-of-installations","current-installation","room-name"])]))}}};export{te as default};
