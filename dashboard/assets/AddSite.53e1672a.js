import{u as h,al as j,R as b,C as f,c as i,o as y,f as g,b as x,g as I,d as S}from"./vendor.bfb30425.js";import{_ as O}from"./SiteForm.08db87aa.js";import"./TextInput.9e767deb.js";import"./camelCase.8cdf0679.js";import"./SubmitButton.46db78ca.js";const A={class:"mt-8 max-w-sm sm:max-w-lg"},B={class:"rounded-sm bg-white p-6 shadow-md"},V={setup(E){const d=h(),c=j(),u=b(),{t:n}=f(),p=i(()=>d.state.nav.currentOrgId),m=i(()=>d.getters["nav/isOwner"]),l=async({name:t,description:e,street1:r,street2:a,zip:s,city:o})=>{const v=await w({street1:r,street2:a,zip:s,city:o});_({name:t,description:e,addressId:v})},_=async({name:t,description:e,addressId:r})=>{let a={_jv:{type:"Site",relationships:{operator:{data:{type:"Organization",id:p.value}},address:{data:{type:"Address",id:r}}}},name:t,description:e};try{const{_jv:s}=await d.dispatch("jv/post",[a,{url:"sites/"}]);u.push({name:"sites",params:{siteId:s.id}})}catch{c.error(n("site.createError"))}},w=async({street1:t,street2:e,zip:r,city:a})=>{let s={_jv:{type:"Address"},street1:t,street2:e,zip:r,city:a};try{const{_jv:o}=await d.dispatch("jv/post",[s,{url:"/addresses/"}]);return o.id}catch(o){c.error(n("address.createError")),console.log(o)}};return(t,e)=>(y(),g("div",A,[x("div",B,[I(O,{"allow-edit":S(m),"button-text":"site.add","on-submit":l},null,8,["allow-edit"])])]))}};export{V as default};
